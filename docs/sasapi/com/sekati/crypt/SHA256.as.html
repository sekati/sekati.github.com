<?xml version="1.0"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head><title>SASAPI</title><script src="../../../quicknav.js" type="text/javascript"></script><script><!--
document.quicknavBasePath="../../../index-files";
//--></script><link href="../../../style.css" title="JavaDoc" rel="stylesheet" type="text/css"/><link href="../../../unnatural.css" title="Unnatural" rel="alternate stylesheet" type="text/css"/><link href="../../../overview-summary.html" title="Overview" rel="top"/><meta name="generator" content="http://www.badgers-in-foil.co.uk/projects/as2api/"/></head><body><pre><span class="lineno" id="1">     1  </span><span class="comment doc">/**<span class="lineno" id="2">     2  </span> * com.sekati.crypt.SHA256<span class="lineno" id="3">     3  </span> * @version 1.0.7<span class="lineno" id="4">     4  </span> * @author jason m horwitz | sekati.com<span class="lineno" id="5">     5  </span> * Copyright (C) 2007  jason m horwitz, Sekat LLC. All Rights Reserved.<span class="lineno" id="6">     6  </span> * Released under the MIT License: http://www.opensource.org/licenses/mit-license.php<span class="lineno" id="7">     7  </span> */</span><span class="lineno" id="8">     8  </span><span class="key">import</span> com.sekati.crypt.IHash;<span class="lineno" id="9">     9  </span><span class="lineno" id="10">    10  </span><span class="comment doc">/**<span class="lineno" id="11">    11  </span> * Calculate NIST compatible SHA256 checksum hash. <span class="lineno" id="12">    12  </span> * @see {@link http://anmar.eu.org/projects/jssha2}<span class="lineno" id="13">    13  </span> */</span><span class="lineno" id="14">    14  </span><span class="key">class</span> com.sekati.crypt.SHA256 <span class="key">implements</span> IHash {<span class="lineno" id="15">    15  </span><span class="lineno" id="16">    16  </span>	<span class="comment">/* bits per input character. 8 - ASCII; 16 - Unicode      */</span><span class="lineno" id="17">    17  </span>	<span class="comment">//private var chrsz:Number = 8;</span><span class="lineno" id="18">    18  </span>	<span class="comment">/* hex output format. 0 - lowercase; 1 - uppercase        */</span><span class="lineno" id="19">    19  </span>	<span class="comment">//private var hexcase:Number = 0;</span><span class="lineno" id="20">    20  </span>	<span class="lineno" id="21">    21  </span>	<span class="comment doc">/**<span class="lineno" id="22">    22  </span>	 * Calculates the SHA256 checksum.<span class="lineno" id="23">    23  </span>	 * @param src (String) string to hash<span class="lineno" id="24">    24  </span>	 * @return String<span class="lineno" id="25">    25  </span>	 */</span><span class="lineno" id="26">    26  </span>	<span class="key">public</span> <span class="key">static</span> <span class="key">function</span> calculate(str:String):String {<span class="lineno" id="27">    27  </span>		<span class="key">return</span> hex_sha256( str );<span class="lineno" id="28">    28  </span>	}<span class="lineno" id="29">    29  </span><span class="lineno" id="30">    30  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> safe_add(x:Number, y:Number):Number {<span class="lineno" id="31">    31  </span>		<span class="key">var</span> lsw:Number = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);<span class="lineno" id="32">    32  </span>		<span class="key">var</span> msw:Number = (x &gt;&gt; <span class="num_const">16</span>) + (y &gt;&gt; <span class="num_const">16</span>) + (lsw &gt;&gt; <span class="num_const">16</span>);<span class="lineno" id="33">    33  </span>		<span class="key">return</span> (msw &lt;&lt; <span class="num_const">16</span>) | (lsw &amp; 0xFFFF);<span class="lineno" id="34">    34  </span>	}<span class="lineno" id="35">    35  </span><span class="lineno" id="36">    36  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> S(X:Number, n:Number):Number { <span class="lineno" id="37">    37  </span>		<span class="key">return</span> (X &gt;&gt;&gt; n) | (X &lt;&lt; (<span class="num_const">32</span> - n)); <span class="lineno" id="38">    38  </span>	}<span class="lineno" id="39">    39  </span><span class="lineno" id="40">    40  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> R(X:Number, n:Number):Number { <span class="lineno" id="41">    41  </span>		<span class="key">return</span> (X &gt;&gt;&gt; n); <span class="lineno" id="42">    42  </span>	}<span class="lineno" id="43">    43  </span><span class="lineno" id="44">    44  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Ch(x:Number, y:Number, z:Number):Number { <span class="lineno" id="45">    45  </span>		<span class="key">return</span> ((x &amp; y) ^ ((~x) &amp; z)); <span class="lineno" id="46">    46  </span>	}<span class="lineno" id="47">    47  </span><span class="lineno" id="48">    48  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Maj(x:Number, y:Number, z:Number):Number { <span class="lineno" id="49">    49  </span>		<span class="key">return</span> ((x &amp; y) ^ (x &amp; z) ^ (y &amp; z)); <span class="lineno" id="50">    50  </span>	}<span class="lineno" id="51">    51  </span><span class="lineno" id="52">    52  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Sigma0256(x:Number):Number { <span class="lineno" id="53">    53  </span>		<span class="key">return</span> (S( x, <span class="num_const">2</span> ) ^ S( x, <span class="num_const">13</span> ) ^ S( x, <span class="num_const">22</span> )); <span class="lineno" id="54">    54  </span>	}<span class="lineno" id="55">    55  </span><span class="lineno" id="56">    56  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Sigma1256(x:Number):Number { <span class="lineno" id="57">    57  </span>		<span class="key">return</span> (S( x, <span class="num_const">6</span> ) ^ S( x, <span class="num_const">11</span> ) ^ S( x, <span class="num_const">25</span> )); <span class="lineno" id="58">    58  </span>	}<span class="lineno" id="59">    59  </span><span class="lineno" id="60">    60  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Gamma0256(x:Number):Number { <span class="lineno" id="61">    61  </span>		<span class="key">return</span> (S( x, <span class="num_const">7</span> ) ^ S( x, <span class="num_const">18</span> ) ^ R( x, <span class="num_const">3</span> )); <span class="lineno" id="62">    62  </span>	}<span class="lineno" id="63">    63  </span><span class="lineno" id="64">    64  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Gamma1256(x:Number):Number { <span class="lineno" id="65">    65  </span>		<span class="key">return</span> (S( x, <span class="num_const">17</span> ) ^ S( x, <span class="num_const">19</span> ) ^ R( x, <span class="num_const">10</span> )); <span class="lineno" id="66">    66  </span>	}<span class="lineno" id="67">    67  </span><span class="lineno" id="68">    68  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Sigma0512(x:Number):Number { <span class="lineno" id="69">    69  </span>		<span class="key">return</span> (S( x, <span class="num_const">28</span> ) ^ S( x, <span class="num_const">34</span> ) ^ S( x, <span class="num_const">39</span> )); <span class="lineno" id="70">    70  </span>	}<span class="lineno" id="71">    71  </span><span class="lineno" id="72">    72  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Sigma1512(x:Number):Number { <span class="lineno" id="73">    73  </span>		<span class="key">return</span> (S( x, <span class="num_const">14</span> ) ^ S( x, <span class="num_const">18</span> ) ^ S( x, <span class="num_const">41</span> )); <span class="lineno" id="74">    74  </span>	}<span class="lineno" id="75">    75  </span><span class="lineno" id="76">    76  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Gamma0512(x:Number):Number { <span class="lineno" id="77">    77  </span>		<span class="key">return</span> (S( x, <span class="num_const">1</span> ) ^ S( x, <span class="num_const">8</span> ) ^ R( x, <span class="num_const">7</span> )); <span class="lineno" id="78">    78  </span>	}<span class="lineno" id="79">    79  </span><span class="lineno" id="80">    80  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> Gamma1512(x:Number):Number { <span class="lineno" id="81">    81  </span>		<span class="key">return</span> (S( x, <span class="num_const">19</span> ) ^ S( x, <span class="num_const">61</span> ) ^ R( x, <span class="num_const">6</span> )); <span class="lineno" id="82">    82  </span>	}<span class="lineno" id="83">    83  </span><span class="lineno" id="84">    84  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> core_sha256(m:Array, l:Number):Array {<span class="lineno" id="85">    85  </span>		<span class="key">var</span> K:Array = [ 0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2 ];<span class="lineno" id="86">    86  </span>		<span class="key">var</span> HASH:Array = [ 0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19 ];<span class="lineno" id="87">    87  </span>		<span class="key">var</span> W:Array = <span class="key">new</span> Array( <span class="num_const">64</span> );<span class="lineno" id="88">    88  </span>		<span class="key">var</span> a:Number, b:Number, c:Number, d:Number, e:Number, f:Number, g:Number, h:Number, i:Number, j:Number;<span class="lineno" id="89">    89  </span>		<span class="key">var</span> T1:Number, T2:Number;<span class="lineno" id="90">    90  </span>		<span class="comment">/* append padding */</span><span class="lineno" id="91">    91  </span>		m[l &gt;&gt; <span class="num_const">5</span>] |= 0x80 &lt;&lt; (<span class="num_const">24</span> - l % <span class="num_const">32</span>);<span class="lineno" id="92">    92  </span>		m[((l + <span class="num_const">64</span> &gt;&gt; <span class="num_const">9</span>) &lt;&lt; <span class="num_const">4</span>) + <span class="num_const">15</span>] = l;<span class="lineno" id="93">    93  </span>		<span class="key">for</span> (i = <span class="num_const">0</span>; i &lt; m.length ; i += <span class="num_const">16</span>) {<span class="lineno" id="94">    94  </span>			a = HASH[<span class="num_const">0</span>];<span class="lineno" id="95">    95  </span>			b = HASH[<span class="num_const">1</span>];<span class="lineno" id="96">    96  </span>			c = HASH[<span class="num_const">2</span>];<span class="lineno" id="97">    97  </span>			d = HASH[<span class="num_const">3</span>];<span class="lineno" id="98">    98  </span>			e = HASH[<span class="num_const">4</span>];<span class="lineno" id="99">    99  </span>			f = HASH[<span class="num_const">5</span>];<span class="lineno" id="100">   100  </span>			g = HASH[<span class="num_const">6</span>];<span class="lineno" id="101">   101  </span>			h = HASH[<span class="num_const">7</span>];<span class="lineno" id="102">   102  </span>			<span class="key">for</span> (j = <span class="num_const">0</span>; j &lt; <span class="num_const">64</span> ; j++) {<span class="lineno" id="103">   103  </span>				<span class="key">if</span> (j &lt; <span class="num_const">16</span>) {<span class="lineno" id="104">   104  </span>					W[j] = m[j + i];<span class="lineno" id="105">   105  </span>				} <span class="key">else</span> {<span class="lineno" id="106">   106  </span>					W[j] = safe_add( safe_add( safe_add( Gamma1256( W[j - <span class="num_const">2</span>] ), W[j - <span class="num_const">7</span>] ), Gamma0256( W[j - <span class="num_const">15</span>] ) ), W[j - <span class="num_const">16</span>] );<span class="lineno" id="107">   107  </span>				}<span class="lineno" id="108">   108  </span>				T1 = safe_add( safe_add( safe_add( safe_add( h, Sigma1256( e ) ), Ch( e, f, g ) ), K[j] ), W[j] );<span class="lineno" id="109">   109  </span>				T2 = safe_add( Sigma0256( a ), Maj( a, b, c ) );<span class="lineno" id="110">   110  </span>				h = g;<span class="lineno" id="111">   111  </span>				g = f;<span class="lineno" id="112">   112  </span>				f = e;<span class="lineno" id="113">   113  </span>				e = safe_add( d, T1 );<span class="lineno" id="114">   114  </span>				d = c;<span class="lineno" id="115">   115  </span>				c = b;<span class="lineno" id="116">   116  </span>				b = a;<span class="lineno" id="117">   117  </span>				a = safe_add( T1, T2 );<span class="lineno" id="118">   118  </span>			}<span class="lineno" id="119">   119  </span>			HASH[<span class="num_const">0</span>] = safe_add( a, HASH[<span class="num_const">0</span>] );<span class="lineno" id="120">   120  </span>			HASH[<span class="num_const">1</span>] = safe_add( b, HASH[<span class="num_const">1</span>] );<span class="lineno" id="121">   121  </span>			HASH[<span class="num_const">2</span>] = safe_add( c, HASH[<span class="num_const">2</span>] );<span class="lineno" id="122">   122  </span>			HASH[<span class="num_const">3</span>] = safe_add( d, HASH[<span class="num_const">3</span>] );<span class="lineno" id="123">   123  </span>			HASH[<span class="num_const">4</span>] = safe_add( e, HASH[<span class="num_const">4</span>] );<span class="lineno" id="124">   124  </span>			HASH[<span class="num_const">5</span>] = safe_add( f, HASH[<span class="num_const">5</span>] );<span class="lineno" id="125">   125  </span>			HASH[<span class="num_const">6</span>] = safe_add( g, HASH[<span class="num_const">6</span>] );<span class="lineno" id="126">   126  </span>			HASH[<span class="num_const">7</span>] = safe_add( h, HASH[<span class="num_const">7</span>] );<span class="lineno" id="127">   127  </span>		}<span class="lineno" id="128">   128  </span>		<span class="key">return</span> HASH;<span class="lineno" id="129">   129  </span>	}<span class="lineno" id="130">   130  </span><span class="lineno" id="131">   131  </span>	<span class="comment">/*<span class="lineno" id="132">   132  </span>	private static function core_sha512 (m:Array, l:Number):Void {<span class="lineno" id="133">   133  </span>	var K:Array = [0x428a2f98d728ae22, 0x7137449123ef65cd, 0xb5c0fbcfec4d3b2f, 0xe9b5dba58189dbbc, 0x3956c25bf348b538, 0x59f111f1b605d019, 0x923f82a4af194f9b, 0xab1c5ed5da6d8118, 0xd807aa98a3030242, 0x12835b0145706fbe, 0x243185be4ee4b28c, 0x550c7dc3d5ffb4e2, 0x72be5d74f27b896f, 0x80deb1fe3b1696b1, 0x9bdc06a725c71235, 0xc19bf174cf692694, 0xe49b69c19ef14ad2, 0xefbe4786384f25e3, 0x0fc19dc68b8cd5b5, 0x240ca1cc77ac9c65, 0x2de92c6f592b0275, 0x4a7484aa6ea6e483, 0x5cb0a9dcbd41fbd4, 0x76f988da831153b5, 0x983e5152ee66dfab, 0xa831c66d2db43210, 0xb00327c898fb213f, 0xbf597fc7beef0ee4, 0xc6e00bf33da88fc2, 0xd5a79147930aa725, 0x06ca6351e003826f, 0x142929670a0e6e70, 0x27b70a8546d22ffc, 0x2e1b21385c26c926, 0x4d2c6dfc5ac42aed, 0x53380d139d95b3df, 0x650a73548baf63de, 0x766a0abb3c77b2a8, 0x81c2c92e47edaee6, 0x92722c851482353b, 0xa2bfe8a14cf10364, 0xa81a664bbc423001, 0xc24b8b70d0f89791, 0xc76c51a30654be30, 0xd192e819d6ef5218, 0xd69906245565a910, 0xf40e35855771202a, 0x106aa07032bbd1b8, 0x19a4c116b8d2d0c8, 0x1e376c085141ab53, 0x2748774cdf8eeb99, 0x34b0bcb5e19b48a8, 0x391c0cb3c5c95a63, 0x4ed8aa4ae3418acb, 0x5b9cca4f7763e373, 0x682e6ff3d6b2b8a3, 0x748f82ee5defb2fc, 0x78a5636f43172f60, 0x84c87814a1f0ab72, 0x8cc702081a6439ec, 0x90befffa23631e28, 0xa4506cebde82bde9, 0xbef9a3f7b2c67915, 0xc67178f2e372532b, 0xca273eceea26619c, 0xd186b8c721c0c207, 0xeada7dd6cde0eb1e, 0xf57d4f7fee6ed178, 0x06f067aa72176fba, 0x0a637dc5a2c898a6, 0x113f9804bef90dae, 0x1b710b35131c471b, 0x28db77f523047d84, 0x32caab7b40c72493, 0x3c9ebe0a15c9bebc, 0x431d67c49c100d4c, 0x4cc5d4becb3e42b6, 0x597f299cfc657e2a, 0x5fcb6fab3ad6faec, 0x6c44198c4a475817];<span class="lineno" id="134">   134  </span>	var HASH:Array = [0x6a09e667f3bcc908, 0xbb67ae8584caa73b, 0x3c6ef372fe94f82b, 0xa54ff53a5f1d36f1, 0x510e527fade682d1, 0x9b05688c2b3e6c1f, 0x1f83d9abfb41bd6b, 0x5be0cd19137e2179];<span class="lineno" id="135">   135  </span>	var W:Array = new Array (80);<span class="lineno" id="136">   136  </span>	var a:Number, b:Number, c:Number, d:Number, e:Number, f:Number, g:Number, h:Number, i:Number, j:Number;<span class="lineno" id="137">   137  </span>	var T1:Number, T2:Number;<span class="lineno" id="138">   138  </span>	}<span class="lineno" id="139">   139  </span>	 */</span><span class="lineno" id="140">   140  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> str2binb(str:String):Array {<span class="lineno" id="141">   141  </span>		<span class="key">var</span> bin:Array = <span class="key">new</span> Array( );<span class="lineno" id="142">   142  </span>		<span class="key">var</span> mask:Number = (<span class="num_const">1</span> &lt;&lt; <span class="num_const">8</span>) - <span class="num_const">1</span>;<span class="lineno" id="143">   143  </span>		<span class="key">for</span> (<span class="key">var</span> i:Number = <span class="num_const">0</span>; i &lt; str.length * <span class="num_const">8</span> ; i += <span class="num_const">8</span>) {<span class="lineno" id="144">   144  </span>			bin[i &gt;&gt; <span class="num_const">5</span>] |= (str.charCodeAt( i / <span class="num_const">8</span> ) &amp; mask) &lt;&lt; (<span class="num_const">24</span> - i % <span class="num_const">32</span>);<span class="lineno" id="145">   145  </span>		}<span class="lineno" id="146">   146  </span>		<span class="key">return</span> bin;<span class="lineno" id="147">   147  </span>	}<span class="lineno" id="148">   148  </span><span class="lineno" id="149">   149  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> binb2str(bin:Array):String {<span class="lineno" id="150">   150  </span>		<span class="key">var</span> str:String = <span class="str_const">""</span>;<span class="lineno" id="151">   151  </span>		<span class="key">var</span> mask:Number = (<span class="num_const">1</span> &lt;&lt; <span class="num_const">8</span>) - <span class="num_const">1</span>;<span class="lineno" id="152">   152  </span>		<span class="key">for</span> (<span class="key">var</span> i:Number = <span class="num_const">0</span>; i &lt; bin.length * <span class="num_const">32</span> ; i += <span class="num_const">8</span>) {<span class="lineno" id="153">   153  </span>			str += String.fromCharCode( (bin[i &gt;&gt; <span class="num_const">5</span>] &gt;&gt;&gt; (<span class="num_const">24</span> - i % <span class="num_const">32</span>)) &amp; mask );<span class="lineno" id="154">   154  </span>		}<span class="lineno" id="155">   155  </span>		<span class="key">return</span> str;<span class="lineno" id="156">   156  </span>	}<span class="lineno" id="157">   157  </span><span class="lineno" id="158">   158  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> binb2hex(binarray:Array):String {<span class="lineno" id="159">   159  </span>		<span class="key">var</span> hex_tab:String = <span class="num_const">0</span> ? <span class="str_const">"0123456789ABCDEF"</span> : <span class="str_const">"0123456789abcdef"</span>;<span class="lineno" id="160">   160  </span>		<span class="key">var</span> str:String = <span class="str_const">""</span>;<span class="lineno" id="161">   161  </span>		<span class="key">for</span> (<span class="key">var</span> i:Number = <span class="num_const">0</span>; i &lt; binarray.length * <span class="num_const">4</span> ; i++) {<span class="lineno" id="162">   162  </span>			str += hex_tab.charAt( (binarray[i &gt;&gt; <span class="num_const">2</span>] &gt;&gt; ((<span class="num_const">3</span> - i % <span class="num_const">4</span>) * <span class="num_const">8</span> + <span class="num_const">4</span>)) &amp; 0xF ) + hex_tab.charAt( (binarray[i &gt;&gt; <span class="num_const">2</span>] &gt;&gt; ((<span class="num_const">3</span> - i % <span class="num_const">4</span>) * <span class="num_const">8</span>)) &amp; 0xF );<span class="lineno" id="163">   163  </span>		}<span class="lineno" id="164">   164  </span>		<span class="key">return</span> str;<span class="lineno" id="165">   165  </span>	}<span class="lineno" id="166">   166  </span><span class="lineno" id="167">   167  </span>	<span class="comment">/*<span class="lineno" id="168">   168  </span>	function binb2b64 (binarray:Array):String {<span class="lineno" id="169">   169  </span>	var tab:String = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";<span class="lineno" id="170">   170  </span>	var str:String = "";<span class="lineno" id="171">   171  </span>	for(var i:Number = 0; i &lt; binarray.length * 4; i += 3) {<span class="lineno" id="172">   172  </span>	var triplet:Number = (((binarray[i   &gt;&gt; 2] &gt;&gt; 8 * (3 -  i   %4)) &amp; 0xFF) &lt;&lt; 16) | (((binarray[i+1 &gt;&gt; 2] &gt;&gt; 8 * (3 - (i+1)%4)) &amp; 0xFF) &lt;&lt; 8 ) |  ((binarray[i+2 &gt;&gt; 2] &gt;&gt; 8 * (3 - (i+2)%4)) &amp; 0xFF);<span class="lineno" id="173">   173  </span>	for(var j:Number = 0; j &lt; 4; j++) {<span class="lineno" id="174">   174  </span>	if (i * 8 + j * 6 &gt; binarray.length * 32) str += b64pad; else str += tab.charAt((triplet &gt;&gt; 6*(3-j)) &amp; 0x3F);<span class="lineno" id="175">   175  </span>	}<span class="lineno" id="176">   176  </span>	}<span class="lineno" id="177">   177  </span>	return str;<span class="lineno" id="178">   178  </span>	}	<span class="lineno" id="179">   179  </span>	 */</span><span class="lineno" id="180">   180  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> hex_sha256(s:String):String {<span class="lineno" id="181">   181  </span>		<span class="key">return</span> binb2hex( core_sha256( str2binb( s ), s.length * <span class="num_const">8</span> ) );<span class="lineno" id="182">   182  </span>	}<span class="lineno" id="183">   183  </span><span class="lineno" id="184">   184  </span>	<span class="key">private</span> <span class="key">static</span> <span class="key">function</span> str_sha256(s:String):String {<span class="lineno" id="185">   185  </span>		<span class="key">return</span> binb2str( core_sha256( str2binb( s ), s.length * <span class="num_const">8</span> ) );<span class="lineno" id="186">   186  </span>	}<span class="lineno" id="187">   187  </span><span class="lineno" id="188">   188  </span>	<span class="key">private</span> <span class="key">function</span> SHA256() {<span class="lineno" id="189">   189  </span>	}<span class="lineno" id="190">   190  </span>}</pre><ul class="main_nav" id="main_nav"><li><a href="../../../overview-summary.html" title="Overview of SASAPI" class="button">Overview</a></li><li><a href="package-summary.html" title="Overview of package com.sekati.crypt" class="button">Package</a></li><li><a href="SHA256.html" title="Detail of com.sekati.crypt.SHA256 API" class="button">Class</a></li><li><span class="button nav_current">Source</span></li><li><a href="../../../index-files/index.html" title="Alpabetical index of types and members" class="button">Index</a></li></ul><div class="footer"><a href="http://www.badgers-in-foil.co.uk/projects/as2api/" title="ActionScript 2 API Documentation Generator">as2api</a></div></body></html>